# 区块链钱包开发学习任务清单

## 1. 密码学基础 (Cryptography Foundations)

- [x] 对称加密 (DES, AES) 实现 Demo <!-- id: 0 -->
  - _已完成: 代码注释与输出已中文化_
- [x] 非对称加密 (RSA, ECDSA, EDDSA) 实现 Demo <!-- id: 1 -->
  - _已完成: 代码注释与输出已中文化_
- [x] 哈希与海绵函数 (MD5, SHA, Keccak, Blake3) <!-- id: 2 -->
  - _已完成: 代码注释与输出已中文化_
- [x] **实战项目:** 安全密钥管理服务 (Mock KMS) <!-- id: 3 -->
  - _Web2 技术点: Go 接口设计 (Interface), 单元测试 (Unit Testing)_
  - _已完成: 实现了 LocalKMS (内存版 HSM), 支持 AES/RSA/ECDSA/Ed25519 的创建、签名、验证、加密、解密。_

## 2. 钱包基础与标准 (Wallet Fundamentals & Standards)

- [x] BIP-39 (助记词生成) 实现 <!-- id: 4 -->
  - _已完成: 实现了 MnemonicService, 支持 12/24 词生成与 Seed 转换。_
- [x] BIP-32 (分层确定性钱包) & BIP-44 (多币种支持) <!-- id: 5 -->
  - _Web2 技术点: 库设计 (Pkg Design), 单元测试_
  - _已完成: 实现了 HDWallet, 支持 m/44'/0'/0' 路径派生。_
- [x] 地址生成 (BTC, ETH, TRON 等) <!-- id: 6 -->
  - _已完成: 实现了 BTC (P2PKH) 和 ETH (EIP-55) 地址生成。_
- [x] **实战项目:** 命令行钱包生成器 (CLI Wallet) <!-- id: 7 -->
  - _Web2 技术点: CLI 框架 (Cobra), 文件 I/O 操作_
  - _已完成: 实现了 `wallet-cli new` 命令，可生成助记词、种子、主钥及 BTC/ETH 派生地址。_

## 3. 中心化钱包系统 (Centralized Wallet System)

- [x] 设计钱包系统数据库模型 (用户, 账户, 交易) <!-- id: 8 -->
  - _Web2 技术点: Postgres 数据库设计, 范式化, 索引优化_
  - _已完成: 数据库架构设计文档 (docs/schema_design.md)_
  - _已完成: Docker 环境与数据库迁移 (Auto Migrate)_
- [x] **实现充值地址生成服务 (Address Service)** <!-- id: 9 -->
  - _Web2 技术点: gRPC/ProtoBuf, 微服务架构, Redis INCR (原子计数)_
  - _已完成: 实现了 SQLAddressService, 支持幂等生成 BTC/ETH 地址并存库。_
- [x] **实现区块扫描器 (Observer) - 以 ETH/ERC20 为例** <!-- id: 10 -->
  - _Web2 技术点: 高并发 (Worker Pools), 重试机制_
  - _已完成: 实现了 EthObserver, 使用 Worker Pool 模式并行处理区块交易, 成功检测充值并入库。_
- [x] **消息队列与异步架构 (Message Queues)** <!-- id: MQ -->
  - _Web2 技术点: Redis Streams (轻量级 MQ), 削峰填谷, 生产者/消费者模式_
  - _应用场景: 充值到账通知, 提现请求排队_
  - _已完成: 实现了 Redis Stream Producer/Consumer, 充值事件自动分发。_

## 5. 资金归集与热钱包 (Funds Collection & Hot Wallet) <!-- id: 11 -->

- [x] **私钥导出与签名 (Private Key Derivation)** <!-- id: 5-1 -->
  - _安全核心: 如何在不暴露主私钥的情况下，通过 Path 派生子私钥并签名?_
  - _已完成: 实现了 BIP32 ECPrivKey 导出与 EIP-155 签名。_
- [x] **构造归集交易 (Sweeping)** <!-- id: 5-2 -->
  - _业务逻辑: 检测到充值 -> 计算手续费 -> 构造 Transaction (Deposit Addr -> Hot Wallet)_
  - _已完成: SweeperService 实现了完整归集流程。_
- [x] **交易广播与确认 (Broadcast)** <!-- id: 5-3 -->
  - _技术点: 使用 go-ethereum 客户端发送 Raw Transaction_
  - _已完成: 实现了真实广播与模拟模式的自动切换。_
- [x] **分布式锁 (Distributed Lock)** <!-- id: 5-4 -->
  - _面试点: 防止多实例同时归集同一笔资金 (Double Spending 风险)_
  - _已完成: 基于 Redis SETNX 实现简单分布式锁。 docs/module_5_distributed_lock.md_

## 6. 基础设施与部署 (Infrastructure & Deployment)

- [x] 服务容器化 (Docker) <!-- id: 20 -->
  - _已完成: 编写 Dockerfile (Multi-stage build) 和 docker-compose.yml。_
- [x] Kubernetes (K8s) 部署清单编写 <!-- id: 21 -->
  - _已完成: 建立了 `deploy/k8s` 目录，包含 Deployment, Service, ConfigMap, Secret。_
- [x] CI/CD 流水线搭建 (测试与部署) <!-- id: 22 -->
  - _已完成: 配置了 `.github/workflows/ci.yml`，实现自动 Build 与 Test。_
- [x] 监控与告警 (Prometheus/Grafana 基础) <!-- id: 23 -->
  - _已完成: 在 Module 13 中实现了业务指标监控。_

## 7. 企业级架构升级 (Enterprise Architecture) <!-- id: 24 -->

- [x] **接口重构:** 定义统一的 MQ 接口 (Producer/Consumer) <!-- id: 25 -->
- [x] **中间件迁移:** Redis Streams -> Kafka/RocketMQ 迁移实战 <!-- id: 26 -->
  - _已完成: Kafka 集成, 双监听器配置, 统一 Topic 命名。_
- [x] **分布式事务:** 引入本地消息表 (Transactional Outbox) 解决一致性 <!-- id: 27 -->
  - _已完成: 实现 Outbox 模式, Relay Service, 保证原子写入与至少一次投递。_

## 8. 去中心化钱包 (Decentralized Wallet)

- [x] **本地 Keystore 管理 (Local Key Management)** <!-- id: 13 -->
  - _已完成: 实现了 `pkg/keystore` (Scrypt+AES)，添加 `wallet-cli init` 命令。_
  - _文档: `docs/module_8_guide_keystore.md`_
- [x] **离线签名服务 (Air-gapped Signer)** <!-- id: 14 -->
  - _已完成: 实现了 `wallet-cli build-tx`, `sign`, `broadcast` 完整离线签名工作流。_
  - _文档: `docs/module_8_guide_offline_signing.md`_
- [x] **实战项目:** Web3 移动端钱包后端 (API Gateway) <!-- id: 16 -->
  - _已完成: `wallet-server` 即为后端核心。API Gateway 拆分已规划至 Module 14。_

## 9. 高级概念 (MPC & AA)

- [x] 多签钱包逻辑 (Gnosis Safe 风格) <!-- id: 17 -->
  - _已完成: 实现了业务层多签 (2-of-N)。包含 Admin 审批流、防重放机制、自动广播服务。_
  - _文档: `docs/module_9_guide_multisig_architecture.md` (大师课)_
- [x] 门限签名方案 (TSS/MPC) 概念 Demo <!-- id: 18 -->
  - _已完成: 实现了基于 Shamir's Secret Sharing 的密钥分片 CLI 工具。_
  - _文档: `docs/module_9_guide_mpc_theory.md`_

## 10. 工程化标准与微服务 (Standards & Microservices) [NEW]

- [x] **Go 工程化标准 (Project Layout)** <!-- id: 28 -->
  - _已完成: 重构目录结构 (pkg/wallet -> internal/service, pkg/address)。_
- [x] **统一 API 响应与错误处理 (API Standards)** <!-- id: 29 -->
  - _已完成: 封装统一的 JSON 响应结构 (Code, Msg, Data), 定义业务错误码规范。_
  - _已完成: 集成 Gin Server 并实现 /health 接口。_
- [x] **RPC 与微服务通信 (gRPC & Protobuf)** <!-- id: 30 -->
  - _已完成: 定义 `api/proto/address.proto`。_
  - _已完成: 实现 `internal/handler/grpc/address_handler.go`。_
  - _已完成: 集成 gRPC Server (Port 50051) 到 main.go。_
- [x] **数据库版本化迁移 (golang-migrate)** <!-- id: 35 -->
  - _已完成: 替代 AutoMigrate，实现可回滚、版本控制的数据库变更。_
- [x] **路由层重构 (Router Extraction)** <!-- id: 36 -->
  - _已完成: 将路由注册从 main.go 剥离，实现 Router 模块化。_
- [x] **API 文档自动生成 (Swagger/OpenAPI)** <!-- id: 31 -->
  - _已完成: 使用 swag 生成 API 文档。_

## 11. 生产级工程化 (Production Readiness)

- [x] **定时任务体系 (Cron Jobs)** [NEW] <!-- id: 37 -->
  - _目标: 引入 `robfig/cron` 并结合分布式锁，实现高可用的定时任务。_
- [x] **多级缓存架构 (Local + Redis Cache)** [NEW] <!-- id: 38 -->
  - _目标: 引入 `go-cache`，实现本地+远程混合缓存策略。_
- [x] **输入参数校验 (Validator)** [NEW] <!-- id: 39 -->
  - _目标: 集成 `go-playground/validator`，实现声明式参数校验。_
- [x] **结构化日志 (Structured Logging)** <!-- id: 32 -->
  - _已完成: 引入 Zap, 替换 std log, 实现 JSON 格式日志以便分析。_
- [x] **优雅停机 (Graceful Shutdown)** <!-- id: 33 -->
  - _已完成: 监听 SIGTERM, 保证正在处理的资金逻辑完整执行后才退出。_
- [x] **配置管理 (Viper)** <!-- id: 34 -->
  - _已完成: 支持 config.yaml 与环境变量覆盖，统一管理配置。_

## 12. 最佳实践与测试 (Best Practices & Testing) [NEW]

- [x] **目录结构优化 (internal/server)** <!-- id: 40 -->
  - _已完成: 引入 `internal/server` 封装启动逻辑，遵循 Standard Go Layout。_
  - _已完成: 文档 `docs/module_13_guide_architecture_scalability.md` (路由拆分与任务队列架构)。_
- [x] **DTO 分离 (Data Transfer Objects)** <!-- id: 41 -->
  - _已完成: 建立 `internal/handler/request`，分离 API 参数与 DB 模型。_
- [x] **测试体系 (Testing Strategy)** <!-- id: 42 -->
  - _已完成: 建立 `units` (Service层) 与 `integration` (API层) 双重测试标准。_

## Module 13: 高级扩展性与可观测性 (Advanced Scalability) [NEW]

- [x] **路由模块化重构** <!-- id: 44 -->
  - _已完成: HTTP/gRPC路由拆分。_
- [x] **异步任务队列 (Asynq)** <!-- id: 45 -->
  - _已完成: 引入 Redis 队列处理后台任务。_
- [x] **业务指标监控 (Business Metrics)** <!-- id: 46 -->
  - _已完成: Prometheus 埋点核心业务指标。_

## Module 14: 微服务拆分实战 (Microservices) [已完成]

- [x] **服务拆分设计** <!-- id: 48 -->
  - _已完成: 定义了 User, Wallet, Gateway, Broadcaster 的边界。_
- [x] **服务发现 (Consul/K8s)** <!-- id: 49 -->
  - _已完成: 使用 K8s Service (ClusterIP) 实现服务发现。_
- [x] **API Gateway** <!-- id: 50 -->
  - _已完成: 实现了 `bc-gateway`，基于 Gin 和 gRPC Client 转发请求。_

## Module 15: 压力测试 (Load Testing) [已交付]

- [x] **k6 基准测试** <!-- id: 51 -->
  - _已完成: 编写了 `test/load/k6_script.js`，包含注册、登录、查余额场景。_
  - _已完成: 提供了 `docs/module_15_guide_load_testing.md` 指南。_
- [ ] **性能调优** <!-- id: 52 -->
  - _状态: 因本地环境限制暂停，待后续执行。_

## Module 16: 安全审计 (Security) [已完成]

- [ ] **渗透测试** <!-- id: 53 -->
  - _状态: 需人工介入，已提供 Checklist。_
- [x] **漏洞扫描** <!-- id: 54 -->
  - _已完成: 使用 `govulncheck` 扫描依赖，未发现高危漏洞。_
- [x] **代码审计**
  - _已完成: 确认无硬编码私钥，SQL 注入风险已排除。_

## Module 17: MPC 钱包服务化 (MPC Service) [NEW]

- [ ] **TSS 协议实现 (GG18/CMP)** <!-- id: 59 -->
  - _目标: 将 CLI Demo 升级为 gRPC 服务 (`mpc-service`)。_
- [ ] **分布式密钥生成 (DKG)** <!-- id: 60 -->
  - _目标: 协调多个参与方 (Parties) 生成分片，私钥永不完整出现。_
- [ ] **协同签名 (TssSign)** <!-- id: 61 -->
  - _目标: 多个节点协作完成签名 (M-of-N)。_

## Module 18: 多链扩展 (Multi-Chain Expansion) - TRON [NEW]

- [ ] **波场基础 (TRON Protocols)** <!-- id: 55 -->
  - _目标: 理解 TRC-10/20, Bandwidth/Energy 资源模型。_
- [ ] **TRON 节点集成** <!-- id: 56 -->
  - _目标: 部署 `java-tron` 或使用 Nile 测试网 API。_
- [ ] **地址生成与离线签名** <!-- id: 57 -->
  - _目标: 实现 Base58Check 地址生成与 Protocol Buffers 交易签名。_
- [ ] **USDT 归集** <!-- id: 58 -->
  - _目标: 监听 TRC-20 Transfer 事件并执行归集。_

## Module 19: 基础设施自动化 (Infrastructure as Code) [NEW]

- [ ] **Helm Charts** <!-- id: 62 -->
  - _目标: 将 K8s YAML 模板化，支持多环境 (Dev/Staging/Prod) 部署。_
- [ ] **Terraform (AWS/GCP)** <!-- id: 63 -->
  - _目标: 编排云资源 (RDS, ElastiCache, MSK)。_

## Module 20: 全链路监控与日志 (Observability) [NEW]

- [ ] **集中式日志 (ELK/EFK)** <!-- id: 64 -->
  - _目标: 收集所有微服务日志到 Elasticsearch，使用 Kibana 分析。_
- [ ] **分布式链路追踪 (Jaeger/Tempo)** <!-- id: 65 -->
  - _目标: 追踪 gRPC 调用链，定位性能瓶颈。_
- [ ] **Grafana 大盘** <!-- id: 66 -->
  - _目标: 可视化钱包资产流向、接口延迟、错误率。_
